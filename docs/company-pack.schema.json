{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://tailoredagents.com/schemas/company-pack.schema.json",
  "title": "Company Pack",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "packVersion",
    "companyKey",
    "updatedAt",
    "identity",
    "branding",
    "businessHours",
    "serviceArea",
    "pricing",
    "crm",
    "automation",
    "ai",
    "website"
  ],
  "properties": {
    "packVersion": {
      "type": "integer",
      "minimum": 1,
      "description": "Version of this Company Pack schema."
    },
    "companyKey": {
      "type": "string",
      "minLength": 2,
      "maxLength": 64,
      "pattern": "^[a-z0-9][a-z0-9-]*$",
      "description": "Stable identifier used for deployment/config (e.g., 'stonegate', 'myst-pressure-washing')."
    },
    "updatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "ISO timestamp of last update to this pack."
    },
    "notes": {
      "type": "string",
      "maxLength": 4000,
      "description": "Optional operator notes about this pack."
    },
    "identity": {
      "type": "object",
      "additionalProperties": false,
      "required": ["legalName", "displayName"],
      "properties": {
        "legalName": { "type": "string", "minLength": 2, "maxLength": 120 },
        "displayName": { "type": "string", "minLength": 2, "maxLength": 80 },
        "tagline": { "type": "string", "maxLength": 120 },
        "timezone": {
          "type": "string",
          "default": "America/New_York",
          "description": "IANA timezone string."
        }
      }
    },
    "branding": {
      "type": "object",
      "additionalProperties": false,
      "required": ["primaryPhoneE164"],
      "properties": {
        "primaryPhoneE164": { "type": "string", "minLength": 8, "maxLength": 18 },
        "supportSmsE164": { "type": "string", "minLength": 8, "maxLength": 18 },
        "supportEmail": { "type": "string", "format": "email" },
        "logoUrl": { "type": "string", "format": "uri" },
        "brandPrimaryColor": { "type": "string", "pattern": "^#[0-9a-fA-F]{6}$" },
        "brandSecondaryColor": { "type": "string", "pattern": "^#[0-9a-fA-F]{6}$" },
        "googleReviewUrl": { "type": "string", "format": "uri" },
        "address": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "line1": { "type": "string", "maxLength": 120 },
            "line2": { "type": "string", "maxLength": 120 },
            "city": { "type": "string", "maxLength": 80 },
            "state": { "type": "string", "maxLength": 40 },
            "postalCode": { "type": "string", "maxLength": 20 }
          }
        }
      }
    },
    "businessHours": {
      "type": "object",
      "additionalProperties": false,
      "required": ["enabled", "days"],
      "properties": {
        "enabled": { "type": "boolean", "default": true },
        "days": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["day", "open", "close"],
            "properties": {
              "day": {
                "type": "string",
                "enum": ["mon", "tue", "wed", "thu", "fri", "sat", "sun"]
              },
              "open": { "type": "string", "pattern": "^[0-2][0-9]:[0-5][0-9]$" },
              "close": { "type": "string", "pattern": "^[0-2][0-9]:[0-5][0-9]$" }
            }
          }
        },
        "holidays": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["date", "closed"],
            "properties": {
              "date": { "type": "string", "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$" },
              "closed": { "type": "boolean" },
              "open": { "type": "string", "pattern": "^[0-2][0-9]:[0-5][0-9]$" },
              "close": { "type": "string", "pattern": "^[0-2][0-9]:[0-5][0-9]$" },
              "note": { "type": "string", "maxLength": 160 }
            }
          }
        }
      }
    },
    "serviceArea": {
      "type": "object",
      "additionalProperties": false,
      "required": ["mode", "rules"],
      "properties": {
        "mode": {
          "type": "string",
          "enum": ["allowlist", "warning", "none"],
          "description": "allowlist = out-of-area warning + optional disqualify; warning = warn only; none = no checks."
        },
        "rules": {
          "type": "array",
          "minItems": 0,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["type", "value"],
            "properties": {
              "type": { "type": "string", "enum": ["zip_prefix", "zip_exact", "city", "county", "state"] },
              "value": { "type": "string", "minLength": 1, "maxLength": 64 },
              "label": { "type": "string", "maxLength": 80 }
            }
          }
        },
        "outOfAreaBehavior": {
          "type": "string",
          "enum": ["warn_only", "disqualify", "route_to_manual_review"],
          "default": "warn_only"
        }
      }
    },
    "pricing": {
      "type": "object",
      "additionalProperties": false,
      "required": ["currency", "discountPercent", "services"],
      "properties": {
        "currency": { "type": "string", "enum": ["USD"] },
        "discountPercent": { "type": "number", "minimum": 0, "maximum": 100, "default": 15 },
        "services": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["serviceKey", "tiers"],
            "properties": {
              "serviceKey": { "type": "string", "minLength": 2, "maxLength": 64 },
              "displayName": { "type": "string", "maxLength": 80 },
              "tiers": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "type": "object",
                  "additionalProperties": false,
                  "required": ["tierKey", "label", "amount"],
                  "properties": {
                    "tierKey": { "type": "string", "minLength": 1, "maxLength": 64 },
                    "label": { "type": "string", "minLength": 1, "maxLength": 80 },
                    "amount": { "type": "number", "minimum": 0 }
                  }
                }
              }
            }
          }
        }
      }
    },
    "crm": {
      "type": "object",
      "additionalProperties": false,
      "required": ["pipelineStages", "defaultAssignee"],
      "properties": {
        "pipelineStages": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1, "maxLength": 60 }
        },
        "defaultAssignee": {
          "type": "object",
          "additionalProperties": false,
          "required": ["mode"],
          "properties": {
            "mode": {
              "type": "string",
              "enum": ["fixed_member", "round_robin", "manual"],
              "description": "fixed_member assigns all new leads to a single member by default."
            },
            "memberId": { "type": "string", "format": "uuid" }
          }
        },
        "leadDefinition": {
          "type": "string",
          "enum": ["new_contact_is_lead", "pipeline_new_is_lead"],
          "default": "new_contact_is_lead"
        }
      }
    },
    "automation": {
      "type": "object",
      "additionalProperties": false,
      "required": ["enabled", "salesAutopilot"],
      "properties": {
        "enabled": { "type": "boolean", "default": true },
        "salesAutopilot": {
          "type": "object",
          "additionalProperties": false,
          "required": ["mode", "draftSendDelayMin"],
          "properties": {
            "mode": { "type": "string", "enum": ["off", "draft_only", "draft_then_send"] },
            "draftSendDelayMin": { "type": "integer", "minimum": 0, "maximum": 1440, "default": 15 }
          }
        },
        "speedToLead": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "slaMinutes": { "type": "integer", "minimum": 1, "maximum": 60, "default": 5 },
            "businessHoursOnly": { "type": "boolean", "default": true }
          }
        }
      }
    },
    "ai": {
      "type": "object",
      "additionalProperties": false,
      "required": ["agentDisplayName", "tone", "models"],
      "properties": {
        "agentDisplayName": { "type": "string", "minLength": 2, "maxLength": 40 },
        "tone": { "type": "string", "maxLength": 2000 },
        "models": {
          "type": "object",
          "additionalProperties": false,
          "required": ["salesThinker", "salesWriter"],
          "properties": {
            "salesThinker": { "type": "string", "minLength": 1, "maxLength": 120 },
            "salesWriter": { "type": "string", "minLength": 1, "maxLength": 120 }
          }
        },
        "knowledgeBase": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "summary": { "type": "string", "maxLength": 20000 },
            "sourceUris": {
              "type": "array",
              "maxItems": 50,
              "items": { "type": "string", "maxLength": 400 }
            }
          }
        }
      }
    },
    "website": {
      "type": "object",
      "additionalProperties": false,
      "required": ["templateKey", "services", "areas"],
      "properties": {
        "templateKey": { "type": "string", "minLength": 2, "maxLength": 64 },
        "hero": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "headline": { "type": "string", "maxLength": 120 },
            "subheadline": { "type": "string", "maxLength": 240 },
            "primaryCtaLabel": { "type": "string", "maxLength": 40 },
            "primaryCtaHref": { "type": "string", "maxLength": 200 }
          }
        },
        "services": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["slug", "name"],
            "properties": {
              "slug": { "type": "string", "minLength": 1, "maxLength": 80 },
              "name": { "type": "string", "minLength": 1, "maxLength": 80 },
              "summary": { "type": "string", "maxLength": 240 }
            }
          }
        },
        "areas": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["slug", "name"],
            "properties": {
              "slug": { "type": "string", "minLength": 1, "maxLength": 80 },
              "name": { "type": "string", "minLength": 1, "maxLength": 120 }
            }
          }
        },
        "customPages": {
          "type": "array",
          "maxItems": 50,
          "items": {
            "type": "object",
            "additionalProperties": false,
            "required": ["path", "title", "blocks"],
            "properties": {
              "path": { "type": "string", "pattern": "^/[a-z0-9\\-/]*$" },
              "title": { "type": "string", "minLength": 1, "maxLength": 120 },
              "blocks": {
                "type": "array",
                "minItems": 1,
                "items": { "type": "string", "minLength": 1, "maxLength": 80 }
              }
            }
          }
        }
      }
    },
    "integrations": {
      "type": "object",
      "additionalProperties": false,
      "description": "Non-secret integration settings. Secrets remain in env vars.",
      "properties": {
        "twilio": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "fromNumberE164": { "type": "string", "minLength": 8, "maxLength": 18 }
          }
        },
        "meta": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "pageId": { "type": "string", "maxLength": 64 }
          }
        },
        "googleAds": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "customerId": { "type": "string", "pattern": "^[0-9]{6,16}$" },
            "loginCustomerId": { "type": "string", "pattern": "^[0-9]{6,16}$" }
          }
        }
      }
    }
  }
}

